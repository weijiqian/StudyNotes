10å¤§æ’åºç®—æ³•

![image-20200419150726455](../../image-md/image-20200419150726455.png)

### æ’åºç®—æ³•çš„ç¨³å®šæ€§

å¦‚æœç›¸ç­‰çš„2ä¸ªå…ƒç´ ï¼Œåœ¨æ’åºå‰åçš„ç›¸å¯¹ä½ç½®ä¿æŒä¸å˜ï¼Œé‚£ä¹ˆè¿™æ˜¯ç¨³å®šçš„æ’åºç®—æ³• 

æ’åºå‰:5, 1, 3ğ‘, 4, 7, 3ğ‘

ç¨³å®šçš„æ’åº: 1, 3ğ‘, 3ğ‘, 4, 5, 7  

ä¸ç¨³å®šçš„æ’åº:1, 3ğ‘, 3ğ‘, 4, 5, 7 

### åŸåœ°ç®—æ³•

ä¸ä¾èµ–é¢å¤–çš„èµ„æºæˆ–è€…ä¾èµ–å°‘æ•°çš„é¢å¤–èµ„æºï¼Œä»…ä¾é è¾“å‡ºæ¥è¦†ç›–è¾“å…¥

 ç©ºé—´å¤æ‚åº¦ä¸º ğ‘‚(1) çš„éƒ½å¯ä»¥è®¤ä¸ºæ˜¯åŸåœ°ç®—æ³• 



### å†’æ³¡æ’åº

#### æ¦‚å¿µ

(é€‰å‡ºæœ€å¤§çš„ä¸€ä¸ªæ”¾åœ¨æœ€å,å†åœ¨å‰©ä¸‹çš„ä¸­é€‰æ‹©æœ€å¤§çš„.åƒæ°”æ³¡ä¸€æ ·ä»ä¸‹å¾€ä¸Šå†’)

1 ä»å¤´å¼€å§‹æ¯”è¾ƒæ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ï¼Œå¦‚æœç¬¬1ä¸ªæ¯”ç¬¬2ä¸ªå¤§ï¼Œå°±äº¤æ¢å®ƒä»¬çš„ä½ç½® âœ“ æ‰§è¡Œå®Œä¸€è½®åï¼Œæœ€æœ«å°¾é‚£ä¸ªå…ƒç´ å°±æ˜¯æœ€å¤§çš„å…ƒç´ 

2 å¿½ç•¥ 1 ä¸­æ›¾ç»æ‰¾åˆ°çš„æœ€å¤§å…ƒç´ ï¼Œé‡å¤æ‰§è¡Œæ­¥éª¤ 1ï¼Œç›´åˆ°å…¨éƒ¨å…ƒç´ æœ‰åº 	

åŸºæœ¬åŸç†:						 					 					 

```java
for (int end = array.length - 1; end > 0; end--) {
  //æ¯å¾ªç¯ä¸€æ¬¡,æœ€åä¸€ä¸ªå°±æ˜¯æœ€å¤§çš„,å°±ä¸ç”¨å†æ’åº
			for (int begin = 1; begin <= end; begin++) {
				// if (array[begin] < array[begin - 1]) {
				if (cmp(begin, begin - 1) < 0) {
					swap(begin, begin - 1);
				}
			}
		}
```

#### ä¼˜åŒ–1

å¦‚æœåºåˆ—å·²ç»å®Œå…¨æœ‰åºï¼Œå¯ä»¥æå‰ç»ˆæ­¢å†’æ³¡æ’åº 

```java
for (int end = array.length - 1; end > 0; end--) {
			boolean sorted = true;
  //åendä¸ªå·²ç»æœ‰åº
			for (int begin = 1; begin <= end; begin++) {
				// if (array[begin] < array[begin - 1]) {
				if (cmp(begin, begin - 1) < 0) {
					swap(begin, begin - 1);
					sorted = false;
          //ä»ç¬¬1ä¸ªåˆ°ç¬¬endä¸ª,éƒ½æ˜¯æœ‰åºçš„è¯,é‚£ä¹ˆå°±æ˜¯å…¨éƒ¨æœ‰åºäº†.è·³å‡ºå¾ªç¯
				}
			}
			if (sorted) break;
		}
```

#### ä¼˜åŒ–2

å¦‚æœåºåˆ—å°¾éƒ¨å·²ç»å±€éƒ¨æœ‰åºï¼Œå¯ä»¥è®°å½•æœ€å1æ¬¡äº¤æ¢çš„ä½ç½®ï¼Œå‡å°‘æ¯”è¾ƒæ¬¡æ•° 							 					 					 

```java
for (int end = array.length - 1; end > 0; end--) {
			int sortedIndex = 1;
			for (int begin = 1; begin <= end; begin++) {
				// if (array[begin] < array[begin - 1]) {
				if (cmp(begin, begin - 1) < 0) {
					swap(begin, begin - 1);
          //æœ€åä¸€æ¬¡äº¤æ¢,å°±ä»£è¡¨åé¢çš„æ˜¯æœ‰åºçš„.
					sortedIndex = begin;
				}
			}
			end = sortedIndex;
		}
```

### é€‰æ‹©æ’åº

1 ä»åºåˆ—ä¸­æ‰¾å‡ºæœ€å¤§çš„é‚£ä¸ªå…ƒç´ ï¼Œç„¶åä¸æœ€æœ«å°¾çš„å…ƒç´ äº¤æ¢ä½ç½® âœ“ æ‰§è¡Œå®Œä¸€è½®åï¼Œæœ€æœ«å°¾çš„é‚£ä¸ªå…ƒç´ å°±æ˜¯æœ€å¤§çš„å…ƒç´  		

2 å¿½ç•¥ 1 ä¸­æ›¾ç»æ‰¾åˆ°çš„æœ€å¤§å…ƒç´ ï¼Œé‡å¤æ‰§è¡Œæ­¥éª¤ 1						

é€‰æ‹©æ’åºçš„äº¤æ¢æ¬¡æ•°è¦è¿œè¿œå°‘äºå†’æ³¡æ’åºï¼Œå¹³å‡æ€§èƒ½ä¼˜äºå†’æ³¡æ’åº  

 æœ€å¥½ã€æœ€åã€å¹³å‡æ—¶é—´å¤æ‚åº¦:O(n2)ï¼Œç©ºé—´å¤æ‚åº¦:O(1)ï¼Œå±äºä¸ç¨³å®šæ’åº

```java
for (int end = array.length - 1; end > 0; end--) {
			int max = 0;
			for (int begin = 1; begin <= end; begin++) {
				if (cmp(max, begin) < 0) {
					max = begin;
				}
			}
			swap(max, end);
		}
```

### å †æ’åº

æ‰§è¡Œæµç¨‹
 1 å¯¹åºåˆ—è¿›è¡ŒåŸåœ°å»ºå †(heapify)
 2 é‡å¤æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°å †çš„å…ƒç´ æ•°é‡ä¸º 1 

âœ“ äº¤æ¢å †é¡¶å…ƒç´ ä¸å°¾å…ƒç´ 
 âœ“å †çš„å…ƒç´ æ•°é‡å‡ 1
 âœ“å¯¹ 0 ä½ç½®è¿›è¡Œ 1 æ¬¡ siftDown æ“ä½œ



æœ€å¥½,æœ€å.å¹³å‡æ—¶é—´å¤æ‚åº¦O(nlogn) ,ç©ºé—´å¤æ‚åº¦O(1) ,å±äºä¸ç¨³å®šæ’åº.

```java
@Override
	protected void sort() {
		// åŸåœ°å»ºå †
		heapSize = array.length;
		for (int i = (heapSize >> 1) - 1; i >= 0; i--) {
			siftDown(i);
		}
		
		while (heapSize > 1) {
			// äº¤æ¢å †é¡¶å…ƒç´ å’Œå°¾éƒ¨å…ƒç´ 
			swap(0, --heapSize);

			// å¯¹0ä½ç½®è¿›è¡ŒsiftDownï¼ˆæ¢å¤å †çš„æ€§è´¨ï¼‰
			siftDown(0);
		}
	}
	
	private void siftDown(int index) {
		T element = array[index];
		
		int half = heapSize >> 1;
		while (index < half) { // indexå¿…é¡»æ˜¯éå¶å­èŠ‚ç‚¹
			// é»˜è®¤æ˜¯å·¦è¾¹è·Ÿçˆ¶èŠ‚ç‚¹æ¯”
			int childIndex = (index << 1) + 1;
			T child = array[childIndex];
			
			int rightIndex = childIndex + 1;
			// å³å­èŠ‚ç‚¹æ¯”å·¦å­èŠ‚ç‚¹å¤§
			if (rightIndex < heapSize && 
					cmp(array[rightIndex], child) > 0) { 
				child = array[childIndex = rightIndex];
			}
			
			// å¤§äºç­‰äºå­èŠ‚ç‚¹
			if (cmp(element, child) >= 0) break;
			
			array[index] = child;
			index = childIndex;
		}
		array[index] = element;
	}
```

### æ’å…¥æ’åº

æ’å…¥æ’åºéå¸¸ç±»ä¼¼äºæ‰‘å…‹ç‰Œçš„æ’åº

æ‰§è¡Œæµç¨‹ 
1 åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ’å…¥æ’åºä¼šå°†åºåˆ—åˆ†ä¸º2éƒ¨åˆ†  
å¤´éƒ¨æ˜¯å·²ç»æ’å¥½åºçš„ï¼Œå°¾éƒ¨æ˜¯å¾…æ’åºçš„å·²ç»æ’å¥½åº å¾…æ’åº
2 ä»å¤´å¼€å§‹æ‰«ææ¯ä¸€ä¸ªå…ƒç´   âœ“ æ¯å½“æ‰«æåˆ°ä¸€ä¸ªå…ƒç´ ï¼Œå°±å°†å®ƒæ’å…¥åˆ°å¤´éƒ¨åˆé€‚çš„ä½ç½®ï¼Œä½¿å¾—å¤´éƒ¨æ•°æ®ä¾ç„¶ä¿æŒæœ‰åº 

```java
protected void sort() {
		for (int begin = 1; begin < array.length; begin++) {
			int cur = begin;
      //å‰cur-1ä¸ªéƒ½æ˜¯æ’åºå¥½çš„,ä»å°åˆ°å¤§,å¦‚æœcuræ¯”å‰ä¸€ä¸ªå¤§,å°±ä¸‹ä¸€è½®å¾ªç¯
      //å¦‚æœcur æ¯”å‰ä¸€ä¸ªå°,å°±äº¤æ¢,å†æ¯”è¾ƒå‰ä¸€ä¸ªå’Œå‰ä¸¤ä¸ª.
			while (cur > 0 && cmp(cur, cur - 1) < 0) {
				swap(cur, cur - 1);
				cur--;
			}
		}
	}
```

#### é€†åºå¯¹

ä»€ä¹ˆæ˜¯é€†åºå¯¹?  
æ•°ç»„ <2,3,8,6,1> çš„é€†åºå¯¹ä¸º:<2,1> <3,1> <8,1> <8,6> <6,1>ï¼Œå…±5ä¸ªé€†åºå¯¹ 								æ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸é€†åºå¯¹çš„æ•°é‡æˆæ­£æ¯”å…³ç³» 
é€†åºå¯¹çš„æ•°é‡è¶Šå¤šï¼Œæ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦è¶Šé«˜
æœ€åã€å¹³å‡æ—¶é—´å¤æ‚åº¦:O(n2)

æœ€å¥½æ—¶é—´å¤æ‚åº¦:O(n)  

 ç©ºé—´å¤æ‚åº¦:O(1) 

å±äºç¨³å®šæ’åº
å½“é€†åºå¯¹çš„æ•°é‡æå°‘æ—¶ï¼Œæ’å…¥æ’åºçš„æ•ˆç‡ç‰¹åˆ«é«˜ ï°ç”šè‡³é€Ÿåº¦æ¯” O nlogn çº§åˆ«çš„å¿«é€Ÿæ’åºè¿˜è¦å¿«,Ã·æ•ˆç‡ä¹Ÿæ˜¯éå¸¸å¥½çš„ 							 					 				

#### ä¼˜åŒ–

å°†äº¤æ¢å˜ä¸ºæŒªåŠ¨

```java
for (int begin = 1; begin < array.length; begin++) {
			int cur = begin;
			T v = array[cur];
			while (cur > 0 && cmp(v, array[cur - 1]) < 0) {
				array[cur] = array[cur - 1];
				cur--;
			}
			array[cur] = v;
		}
```

#### ä¼˜åŒ–-äºŒåˆ†æŸ¥æ‰¾

```java
/**
	 * åˆ©ç”¨äºŒåˆ†æœç´¢æ‰¾åˆ° index ä½ç½®å…ƒç´ çš„å¾…æ’å…¥ä½ç½®
	 * å·²ç»æ’å¥½åºæ•°ç»„çš„åŒºé—´èŒƒå›´æ˜¯ [0, index)
	 * @param index
	 * @return
	 */
	private int search(int index) {
		int begin = 0;
		int end = index;
		while (begin < end) {
			int mid = (begin + end) >> 1;
			if (cmp(array[index], array[mid]) < 0) {
				end = mid;
			} else {
				begin = mid + 1;
			}
		}
		return begin;
	}
```



### å½’å¹¶æ’åº



æ‰§è¡Œæµç¨‹  

1 ä¸æ–­åœ°å°†å½“å‰åºåˆ—å¹³å‡åˆ†å‰²æˆ2ä¸ªå­åºåˆ— 

â€‹	 ç›´åˆ°ä¸èƒ½å†åˆ†å‰²(åºåˆ—ä¸­åªå‰©1ä¸ªå…ƒç´ ) 

2 ä¸æ–­åœ°å°†2ä¸ªå­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ‰åºåºåˆ— 

â€‹	 ç›´åˆ°æœ€ç»ˆåªå‰©ä¸‹1ä¸ªæœ‰åºåºåˆ— 	

```java
private T[] leftArray;

	@Override
	protected void sort() {
		leftArray = (T[]) new Comparable[array.length >> 1];
		sort(0, array.length);
	}
	
	// T(n) = T(n/2) + T(n/2) + O(n)
	
	/**
	 * å¯¹ [begin, end) èŒƒå›´çš„æ•°æ®è¿›è¡Œå½’å¹¶æ’åº
	 */
	private void sort(int begin, int end) {
		if (end - begin < 2) return;
		
		int mid = (begin + end) >> 1;
		sort(begin, mid);
		sort(mid, end);
		merge(begin, mid, end);
	}
	
	/**
	 * å°† [begin, mid) å’Œ [mid, end) èŒƒå›´çš„åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ‰åºåºåˆ—
	 */
	private void merge(int begin, int mid, int end) {
		int li = 0, le = mid - begin;
		int ri = mid, re = end;
		int ai = begin;
		
		// å¤‡ä»½å·¦è¾¹æ•°ç»„
		for (int i = li; i < le; i++) {
			leftArray[i] = array[begin + i];
		}
		
		// å¦‚æœå·¦è¾¹è¿˜æ²¡æœ‰ç»“æŸ
		while (li < le) { 
			if (ri < re && cmp(array[ri], leftArray[li]) < 0) {
				array[ai++] = array[ri++];
			} else {
				array[ai++] = leftArray[li++];
			}
		}
	}
```


**å½’å¹¶æ’åº â€“ å¤æ‚åº¦åˆ†æ**
  å½’å¹¶æ’åºèŠ±è´¹çš„æ—¶é—´ 
  Tn =2âˆ—Tn/2 +O(n) 
  T1 =O(1)  T n /n=T n/2 /(n/2)+O(1) 

  ä»¤Sn =Tn/n  
  S1 =O(1)  
  S n =S n/2 +O(1)=S n/4 +O(2)=S n/8 +O(3)=S n/2k +O k =S 1 +O(logn)=O(logn) 
  Tn =nâˆ—Sn=O(nlogn) 	
  ç”±äºå½’å¹¶æ’åºæ€»æ˜¯å¹³å‡åˆ†å‰²å­åºåˆ—ï¼Œæ‰€ä»¥æœ€å¥½ã€æœ€åã€å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(nlogn) ï¼Œå±äºç¨³å®šæ’åº 								
  ä»ä»£ç ä¸­ä¸éš¾çœ‹å‡º:å½’å¹¶æ’åºçš„ç©ºé—´å¤æ‚åº¦æ˜¯On/2+logn =O(n) 

n/2 ç”¨äºä¸´æ—¶å­˜æ”¾å·¦ä¾§æ•°ç»„ï¼Œlogn æ˜¯å› ä¸ºé€’å½’è°ƒç”¨ 










